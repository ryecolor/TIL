# 240712 - Git revert & reset
> ## Index
> 
> 1) 특정 Commit을 없던 일로 만드는 `Git revert`
> 2) 특정 Commit으로 되돌아가는 `Git reset`
> 3) `Git Undoing` & `--amend`
> ---

<br>

### 1) 특정 Commit을 없던 일로 만드는 `Git revert`
---
Git revert는 변경 사항을 안전하게 실행 취소하는 `순방향 실행 취소 작업`으로, Commit 기록에서 Commit을 삭제하거나 분리하지 않고, 지정된 변경 사항을 반전시키는 `새 Commit을 생성`한다.
```
Git revert의 작동 원리는 "재설정"이다. 이처럼 Git revert가 프로젝트 기록에서 실행 취소한 단일 Commit을 아예 삭제하지 않는 것은 Git push를 위해 통일성을 유지하려는 목적이다.
```

`git revert <commit id>` : commit message가 아닌 *commit id*를 입력해야 함을 주의한다. 이때 commit id는 앞 4~5자만 입력해도 된다.

`git revert A B C` : *공백*을 사용해 여러 commit id를 나열할 시 한꺼번에 여러 개의 commit을 실행 취소할 수 있다.

`git revert A..D` : '..'을 사용하여 범위를 지정하여 한꺼번에 여러 commit을 실행 취소할 수 있다.

git revert `--no-edit` : 편집기를 열지 않고 추천 메시지를 자동으로 사용할 수 있다.

git revert `--no-commit` : 자동 commit 생성 대신 Staging area에 올리고, 추후 하나의 commit으로 통합하여 직접 commit할 수 있다.

<br>

### ✔ Vim 에디터 사용하기
---
- git revert 실행 시에는 즉시 commit이 새로 생성되므로 `commit message의 작성이 불가능`하다.

- 따라서 git이 자동으로 `Vim 에디터`를 작동시켜 추천하는 commit message를 `주황 글씨`로 나타낸다.

- Vim 에디터 모드
  - `입력 모드` : 텍스트 입력 및 행간 이동, (명령 모드 전환 키 `ESC`)
  - `명령 모드` : 저장 및 보관 (입력 모드 전환 키 `i`, 저장 및 종료 키 `Shift + ;`, `wq`)
  - Vim 에디터의 저장 키는 `write`, 종료 키는 `quit`이므로 그 축약어 `wq`를 쓴다.

<br>
<br>

### 2) 특정 Commit으로 되돌아가는 `Git reset`
---
Git reset은 공동 작업에서는 많이 사용하지 않는 명령어로, 특정 Commit으로 `되돌아가는 작업`을 실행한다. 특정 Commit으로 되돌아갔을 때, 되돌아간 Commit 이후의 Commit은 `모두 삭제`한다.
```
Git reset의 작동 원리는 "되돌리기"다. Git reset의 마치 시계를 과거로 돌리는 듯한 작업은 Commit 역사 안의 파일을 어느 공간으로 옮기는지에 따라 하단의 세 가지 옵션을 사용한다.
```



### ① --soft
> - 되돌아간 이후의 Commit 모두 삭제
> - 삭제된 Commit의 기록을 `Staging area`에 `add된 상태`로 남김
<br>

### ② --mixed
> - 되돌아간 이후의 Commit 모두 삭제
> - 삭제된 Commit의 기록을 `Working directory`에 남김
> - 옵션 설정을 안 할 시 `기본값`으로 적용
<br>

### ③ --hard
> - 되돌아간 이후의 Commit 모두 삭제
> - 삭제된 Commit의 기록을 `전혀 남기지 않음`
> - `git reflog`를 통해 삭제된 Commit id를 조회하고 `git reset --hard <commit id>`로 복구 가능




### 3) `Git Undoing` & `--amend`
---

## 3-1. Git Undoing
`git restore <file>` : 파일 내용을 수정 전으로 되돌리기
> - `Modified 상태`의 파일 되돌리기
> - Working directory에서 파일을 수정한 뒤, 파일의 `수정 사항을 취소`하고, 원래 모습대로 되돌리는 작업
> - 원래 파일로 `덮어쓰는 원리`이기 때문에 수정한 내용은 사라짐
> git restore를 통해 수정 취소 후 해당 내용 `복원 불가`

<br>

`Unstage`
> - `Staging area`에 올라간 파일을 `Working directory`로 내리기
> - 같은 역할을 수행하는 두 명령어 중 `실행 시점`에 따라서 결과 상이
> - `git rm --cached <file>` : git 저장소에 commit이 `없는` 경우 Unstage
> - `git restore --staged <file>` : git 저장소에 commit이 `있는` 경우 Unstage

<br>

## 3-2. Git commit --amend
`git commend --amend` : `바로 직전 생성`한 Commit 수정하기
> - Commit 메시지 수정
> - Commit 전체 수정
> - Commit 전체 수정의 경우, `빠진 파일의 add` 선행 필요
> - 불필요한 Commit을 생성하지 않고, 직전 Commit을 수정할 수 있기 때문에 git에서 꼭 필요한 기능 중 하나

<br>

*`code .` : 현재 위치에서 VSCode 열기